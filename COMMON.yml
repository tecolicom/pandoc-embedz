preamble: |
  {%- macro BETWEEN(s, e) -%}
  SELECT * FROM data WHERE date BETWEEN '{{ s }}' AND '{{ e }}'
  {%- endmacro -%}
global:
  fiscal_year: 2023
  quarter:     4

  year_start: "{{ fiscal_year     }}-04-01"
  year_end:   "{{ fiscal_year + 1 }}-03-31"

  quarters:
    1: { start: '04-01', end: '06-30', offset: 0 }
    2: { start: '07-01', end: '09-30', offset: 0 }
    3: { start: '10-01', end: '12-31', offset: 0 }
    4: { start: '01-01', end: '03-31', offset: 1 }

  quarter_start: "{{ fiscal_year + quarters[quarter].offset }}-{{ quarters[quarter].start }}"
  quarter_end:   "{{ fiscal_year + quarters[quarter].offset }}-{{ quarters[quarter].end }}"

  yearly:    "{{ BETWEEN(year_start, year_end) }}"
  quarterly: "{{ BETWEEN(quarter_start, quarter_end) }}"
